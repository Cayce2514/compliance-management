-# locals: instance, title_attr, description_attr

-code_attr = :slug if local_assigns[:code_attr].nil?
-title_attr = :title if local_assigns[:title_attr].nil?
-description_attr = :description if local_assigns[:description_attr].nil?

-code = instance.send(code_attr) if local_assigns[:code].nil?
-title = instance.send(title_attr) if local_assigns[:title].nil?
-description = instance.send(description_attr) if local_assigns[:description].nil?
-description_inline = sanitize(description, :tags => []) if local_assigns[:description_inline].nil?

.span9
  -if title.present? && description.present?
    -# Both title and description
    .oneline.expand-on-hover
      %span.code
        =code
      %span.title
        =title
        %i.description-inline=description_inline
    .description
      =display_as_html(description)
  -elsif title.present?
    -# Title only
    .oneline.expandable
      %span.code
        =code
      %span.title
        =title
  -elsif description.present?
    -# Description only
    .oneline.description-only.expand-on-hover
      %span.code
        =code
      %span.title
        %i.description-inline=description_inline
    .description.inhover
      =display_as_html(description) do
        %span.code
          =code
        %br
        %br
  -else
    -# Neither (shouldn't happen)
    %span.title (No description)

