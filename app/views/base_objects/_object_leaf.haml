-# locals: instance, title_attr, description_attr

-code_attr = :slug if local_assigns[:code_attr].nil?
-title_attr = :title if local_assigns[:title_attr].nil?
-description_attr = :description if local_assigns[:description_attr].nil?

-code = instance.send(code_attr) if local_assigns[:code].nil?
-title = instance.send(title_attr) if local_assigns[:title].nil?
-description = instance.send(description_attr) if local_assigns[:description].nil?
-description_inline = sanitize(description, :tags => []) if local_assigns[:description_inline].nil?

-object_type = nil if local_assigns[:object_type].nil?
-object_icon = nil if local_assigns[:object_icon].nil?

.span9
  -if title.present? && description.present?
    -# Both title and description
    .oneline.expand-on-hover{:rel => "tooltip", :title => "click to view more"}
      -if object_type.present?
        .grcobject{ :class => object_type }
          %i{ :class => object_icon }
      -elsif object_icon.present?
        %i{ :class => object_icon }
      %span.title
        =code
      %span.title
        =title
        %i.description-inline=description_inline
    .description
      =display_as_html(description)
  -elsif title.present?
    -# Title only
    .oneline.expandable
      -if object_type.present?
        .grcobject{ :class => object_type }
          %i{ :class => object_icon }
      -elsif object_icon.present?
        %i{ :class => object_icon }
      %span.title
        =code
      %span.title
        =title
  -elsif description.present?
    -# Description only
    .oneline.description-only.expand-on-hover{:rel => "tooltip", :title => "click to view full description"}
      -if object_type.present?
        .grcobject{ :class => object_type }
          %i{ :class => object_icon }
      -elsif object_icon.present?
        %i{ :class => object_icon }
      %span.title
        =code
      %span.title
        %i.description-inline=description_inline
    .description.inhover
      =display_as_html(description) do
        %span.title
          =code
        %br
        %br
  -else
    -# Neither (shouldn't happen)
    .oneline
      -if object_type.present?
        .grcobject{ :class => object_type }
          %i{ :class => object_icon }
      -elsif object_icon.present?
        %i{ :class => object_icon }
      %span.title (No description)

